const result=document.querySelector(".result"),buttons=document.querySelectorAll(".buttons button");let currentNumber="",firstOperand=null,operator=null,restart=!1;function updateResult(a=!1){result.innerText=a?0:currentNumber.replace(".",",")}function addDigit(a){","===a&&(currentNumber.includes(",")||!currentNumber)||(restart?(currentNumber=a,restart=!1):currentNumber+=a,updateResult())}function setOperator(a){currentNumber&&(calculate(),firstOperand=parseFloat(currentNumber.replace(",",".")),currentNumber=""),operator=a}function calculate(){if(null===operator||null===firstOperand)return;let a,b=parseFloat(currentNumber.replace(",","."));switch(operator){case"+":a=firstOperand+b;break;case"-":a=firstOperand-b;break;case"\xD7":a=firstOperand*b;break;case"/":a=firstOperand/b;break;default:return;}currentNumber=5<a.toString().split(".")[1]?.length?parseFloat(a.toFixed(5)).toString():a.toString(),operator=null,firstOperand=null,restart=!0,percentageValue=null,updateResult()}function clearCalculator(){currentNumber="",firstOperand=null,operator=null,updateResult(!0)}function setPercentage(){let a=parseFloat(currentNumber)/100;["+","-"].includes(operator)&&(a*=firstOperand||1),5<a.toString().split(".")[1]?.length&&(a=a.toFixed(5).toString()),currentNumber=a.toString(),updateResult()}buttons.forEach(a=>{a.addEventListener("click",()=>{const b=a.innerText;/^[0-9,]+$/.test(b)?addDigit(b):["+","-","\xD7","/"].includes(b)?setOperator(b):"="===b?calculate():"C"===b?clearCalculator():"\xB1"===b?(currentNumber=(-1*parseFloat(currentNumber||firstOperand)).toString(),updateResult()):"%"===b&&setPercentage()})});